<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>T·∫øt Y√™u Th∆∞∆°ng üíñ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      margin: 0;
      background: linear-gradient(to bottom, #2b0000, #000000);
      overflow: hidden;
      font-family: Arial, sans-serif;
      color: white;
    }

    #bgParticles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
      pointer-events: none;
    }

    canvas {
      position: relative;
      z-index: 1;
      display: block;
    }

    .hint {
      position: fixed;
      top: 12%;
      width: 100%;
      text-align: center;
      font-size: 1.5rem;
      color: #ff4d88;
      animation: pulseText 1.5s infinite;
      pointer-events: none;
      z-index: 10;
    }

    @keyframes pulseText {
      0% { opacity: 0.4; }
      50% { opacity: 1; }
      100% { opacity: 0.4; }
    }

  
    /* ===== HOA MAI / ƒê√ÄO R∆†I ===== */
    .petal {
      position: fixed;
      top: -20px;
      width: 20px;
      height: 20px;
      background: url("https://i.imgur.com/1L1Y7VJ.png") no-repeat center/contain;
      pointer-events: none;
      z-index: 40;
      animation: fallPetal 8s linear forwards;
    }

    @keyframes fallPetal {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(120vh) rotate(360deg); opacity: 0; }
    }

    /* ===== CH·ªÆ CH·∫†Y CH√öC T·∫æT ===== */
    .marquee {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: rgba(0,0,0,0.6);
      color: #ffd700;
      font-size: 1.2rem;
      padding: 8px 0;
      z-index: 15;
      overflow: hidden;
      white-space: nowrap;
    }

    .marquee span {
      display: inline-block;
      padding-left: 100%;
      animation: marqueeAnim 15s linear infinite;
    }

    @keyframes marqueeAnim {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }

    /* ===== H·ªòP CH·ªåN QU√Ä ===== */
    .choice-menu {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.88);
      padding: 24px 32px 32px;
      border-radius: 20px;
      text-align: center;
      box-shadow: 0 0 40px rgba(255, 77, 136, 0.8);
      z-index: 20;
      display: none;
      min-width: 320px;
    }

    .choice-menu h2 {
      color: #ff4d88;
      margin-bottom: 16px;
      font-size: 1.4rem;
    }

    .envelopes {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
      justify-items: center;
    }

    .envelope {
      width: 90px;
      height: 120px;
      background: linear-gradient(135deg, #ff4d4d, #ff1f6d);
      border-radius: 10px 10px 6px 6px;
      position: relative;
      cursor: pointer;
      box-shadow: 0 0 15px rgba(255, 77, 136, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      user-select: none;
    }

    .envelope::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 50%;
      background: linear-gradient(135deg, #ff6666, #ff3366);
      clip-path: polygon(0 0, 100% 0, 50% 60%);
    }

    .envelope span {
      z-index: 2;
    }

    .envelope:hover {
      transform: translateY(-4px) scale(1.05);
      transition: 0.2s;
    }

    /* ===== H·ªòP K·∫æT QU·∫¢ ===== */
    .result-box {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.9);
      padding: 28px 36px;
      border-radius: 18px;
      text-align: center;
      box-shadow: 0 0 40px rgba(255, 77, 136, 0.9);
      z-index: 30;
      display: none;
      animation: popIn 0.5s ease;
    }

    @keyframes popIn {
      0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }

    .result-box h2 {
      color: #ff4d88;
      margin-bottom: 12px;
    }

    .result-box button {
      margin-top: 16px;
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      background: #ff4d88;
      color: white;
      cursor: pointer;
    }

    /* ===== HI·ªÜU ·ª®NG PH·ª§ ===== */
    .balloon {
      position: fixed;
      bottom: -60px;
      width: 40px;
      height: 50px;
      background: radial-gradient(circle at 30% 30%, #fff, #ff4d88);
      border-radius: 50%;
      animation: floatUp 4s ease-in forwards;
      pointer-events: none;
      z-index: 50;
    }

    .balloon::after {
      content: '';
      position: absolute;
      bottom: -12px;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 20px;
      background: #fff;
    }

    @keyframes floatUp {
      0% { transform: translateY(0) scale(1); opacity: 1; }
      100% { transform: translateY(-120vh) scale(1.2); opacity: 0; }
    }

    .confetti {
      position: fixed;
      top: -20px;
      width: 10px;
      height: 14px;
      background: red;
      animation: fall 3s linear forwards;
      pointer-events: none;
      z-index: 50;
    }

    @keyframes fall {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(120vh) rotate(720deg); }
    }

    .flash {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 77, 136, 0.25);
      animation: flashAnim 0.4s ease;
      z-index: 60;
      pointer-events: none;
    }

    @keyframes flashAnim {
      0% { opacity: 0; }
      50% { opacity: 1; }
      100% { opacity: 0; }
    }

    .shake {
      animation: shakeAnim 0.5s;
    }

    @keyframes shakeAnim {
      0% { transform: translate(-50%, -50%) translateX(0); }
      25% { transform: translate(-50%, -50%) translateX(-10px); }
      50% { transform: translate(-50%, -50%) translateX(10px); }
      75% { transform: translate(-50%, -50%) translateX(-10px); }
      100% { transform: translate(-50%, -50%) translateX(0); }
    }

    #ytPlayer {
      position: fixed;
      width: 1px;
      height: 1px;
      opacity: 0;
      pointer-events: none;
    }
  </style>
</head>
<body>

  <!-- N·ªÄN HOA ƒê√ÄO BAY -->
  <canvas id="bgParticles"></canvas>

  <!-- TR√ÅI TIM -->
  <canvas id="canvas"></canvas>

  <!-- D√¢y ƒë√®n l·ªìng ngang -->
  <div class="lantern-string"></div>

  <!-- D√¢y ph√°o -->
  <div class="firecracker left"></div>
  <div class="firecracker right"></div>

  <!-- ƒê√®n l·ªìng -->
  <div class="lantern lantern1 left" style="top: 18%;"></div>
  <div class="lantern lantern2 left" style="top: 42%;"></div>
  <div class="lantern lantern3 left" style="top: 66%;"></div>

  <div class="lantern lantern1 right" style="top: 18%;"></div>
  <div class="lantern lantern2 right" style="top: 42%;"></div>
  <div class="lantern lantern3 right" style="top: 66%;"></div>

  <!-- C√¢u ƒë·ªëi -->
  <div class="scroll left"></div>
  <div class="scroll right"></div>

  <div class="hint" id="hint">üëâ Ch·∫°m v√†o tr√°i tim ƒëi üëà</div>

  <div class="choice-menu" id="choiceMenu">
    <h2>üéÅ M·ªùi em ch·ªçn qu√† T·∫øt n√® üéÅ</h2>
    <div class="envelopes" id="choicesContainer"></div>
  </div>

  <div class="result-box" id="resultBox">
    <h2>üíñ Qu√† c·ªßa em üíñ</h2>
    <p id="resultText"></p>
    <button id="nextBtn">Ti·∫øp theo üíå</button>
  </div>

  <!-- Ch·ªØ ch·∫°y -->
  <div class="marquee">
    <span>üå∏ Ch√∫c em nƒÉm m·ªõi th·∫≠t nhi·ªÅu ni·ªÅm vui, h·∫°nh ph√∫c v√† lu√¥n ·ªü b√™n anh üíñ | üßß An khang th·ªãnh v∆∞·ª£ng - V·∫°n s·ª± nh∆∞ √Ω üßß | üíï üíï</span>
  </div>

  <div id="ytPlayer"></div>
  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    const hint = document.getElementById('hint');
    const choiceMenu = document.getElementById('choiceMenu');
    const choicesContainer = document.getElementById('choicesContainer');
    const resultBox = document.getElementById('resultBox');
    const resultText = document.getElementById('resultText');
    const nextBtn = document.getElementById('nextBtn');

    let player;
    let hasPlayedMusic = false;
    let showingConfession = false;

    const choices = [
      'L√¨ x√¨ 100k üíµ',
      'M·ªôt bu·ªïi ƒëi xem phim(n·∫øu em mu·ªën) üçø',
      'M·ªôt bu·ªïi d·∫°o ph·ªë ƒÉn v·∫∑t c√πng nhau üç°',
      'M·ªôt c√°i √¥m th·∫≠t ch·∫∑t ü§ó',
      'nhi·ªÅu l·ªùi ch√∫c d·ªÖ th∆∞∆°ng m·ªói ng√†y üí¨',
      'M·ªôt m√≥n qu√† b√≠ m·∫≠t üéÅ'
    ];

    const confessionText = `
      üíå Em √†‚Ä¶ <br><br>
      Hy v·ªçng m√≥n qu√† nh·ªè n√†y l√†m em c∆∞·ªùi gi·ªëng nh∆∞ em l√†m anh vui khi n√≥i chuy·ªán. <br>
      T·ª´ l√∫c bi·∫øt em, anh bi·∫øt m√¨nh ƒë√£ n√≥i chuy·ªán ƒë√∫ng ng∆∞·ªùi. <br>
      tuy ch√∫ng ta ch·ªâ m·ªõi quen nhau ch∆∞a l√¢u, <br>
      nh∆∞ng anh ƒë√£ c·∫£m nh·∫≠n ƒë∆∞·ª£c s·ª± ƒë·∫∑c bi·ªát c·ªßa em. <br>
      mong chung ta c√≥ th·ªÉ n√≥i chuy·ªán th·∫≠t nhi·ªÅu h∆°n. <br><br>
                    üíñüíñüíñüíñüíñüíñüíñ
    `;

    function onYouTubeIframeAPIReady() {
      player = new YT.Player('ytPlayer', {
        height: '1',
        width: '1',
        videoId: 'BnfaIDwb-y0',
        playerVars: {
          autoplay: 0,
          controls: 0,
          loop: 1,
          playlist: 'BnfaIDwb-y0'
        }
      });
    }

    function playMusic() {
      if (player && player.playVideo && !hasPlayedMusic) {
        player.playVideo();
        hasPlayedMusic = true;
      }
    }

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function heartFunction(t) {
      const x = 16 * Math.pow(Math.sin(t), 3);
      const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
      return { x, y };
    }

    const dots = [];
    const DOT_COUNT = 1600;

    for (let i = 0; i < DOT_COUNT; i++) {
      const t = Math.random() * Math.PI * 2;
      const pos = heartFunction(t);
      dots.push({
        x: pos.x,
        y: pos.y,
        z: (Math.random() - 0.5) * 4,
        size: Math.random() * 2 + 1,
        offset: Math.random() * Math.PI * 2
      });
    }

    function draw(time) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const scale = Math.min(canvas.width, canvas.height) / 40;
      const cx = canvas.width / 2;
      const cy = canvas.height / 2;

      dots.forEach(dot => {
        const pulse = 1 + 0.1 * Math.sin(time * 0.003 + dot.offset);
        const zRot = dot.z;
        let perspective = 1 / (1 + zRot * 0.08);
        if (perspective < 0.05) perspective = 0.05;
        const radius = dot.size * perspective;
        const x = cx + dot.x * scale * pulse * perspective;
        const y = cy - dot.y * scale * pulse * perspective;

        ctx.beginPath();
        ctx.arc(x, y, radius, 0, Math.PI * 2);
        ctx.fillStyle = '#ff4d88';
        ctx.fill();
      });

      requestAnimationFrame(draw);
    }

    requestAnimationFrame(draw);

    canvas.addEventListener('click', (e) => {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      const cx = canvas.width / 2;
      const cy = canvas.height / 2;

      const dx = x - cx;
      const dy = y - cy;
      const dist = Math.sqrt(dx * dx + dy * dy);
      const heartRadius = Math.min(canvas.width, canvas.height) / 6;

      if (dist < heartRadius) {
        showChoices();
        hint.style.display = 'none';
        playMusic();
      }
    });

    function showChoices() {
      choicesContainer.innerHTML = '';
      choices.forEach((text, index) => {
        const env = document.createElement('div');
        env.className = 'envelope';
        env.innerHTML = '<span>üßß</span>';
        env.addEventListener('click', () => {
          showResult(text, index);
        });
        choicesContainer.appendChild(env);
      });
      choiceMenu.style.display = 'block';
    }

    function showResult(text, index) {
      choiceMenu.style.display = 'none';
      resultText.textContent = text;
      resultBox.style.display = 'block';
      applyEffect(index);
    }

    nextBtn.addEventListener('click', () => {
      if (!showingConfession) {
        showingConfession = true;
        resultText.innerHTML = confessionText;
        nextBtn.textContent = 'üíñ ƒê·ªìng √Ω üíñ';
        spawnConfetti(40);
        spawnBalloons(25);
      } else {
        resultBox.style.display = 'none';
      }
    });

    function applyEffect(index) {
      switch (index) {
        case 0:
          spawnBalloons(25);
          break;
        case 1:
          spawnConfetti(40);
          break;
        case 2:
          flashScreen();
          break;
        case 3:
          shakeBox();
          spawnBalloons(15);
          break;
        case 4:
          spawnConfetti(30);
          flashScreen();
          break;
        case 5:
          shakeBox();
          spawnConfetti(20);
          spawnBalloons(20);
          break;
      }
    }

    function spawnBalloons(count) {
      for (let i = 0; i < count; i++) {
        const balloon = document.createElement('div');
        balloon.className = 'balloon';
        balloon.style.left = Math.random() * window.innerWidth + 'px';
        balloon.style.animationDuration = 3 + Math.random() * 3 + 's';
        balloon.style.background = `radial-gradient(circle at 30% 30%, #fff, hsl(${Math.random() * 360}, 80%, 60%))`;
        document.body.appendChild(balloon);
        setTimeout(() => balloon.remove(), 6000);
      }
    }

    function spawnConfetti(count) {
      for (let i = 0; i < count; i++) {
        const conf = document.createElement('div');
        conf.className = 'confetti';
        conf.style.left = Math.random() * window.innerWidth + 'px';
        conf.style.background = `hsl(${Math.random() * 360}, 80%, 60%)`;
        conf.style.animationDuration = 2 + Math.random() * 2 + 's';
        document.body.appendChild(conf);
        setTimeout(() => conf.remove(), 4000);
      }
    }

    function flashScreen() {
      const flash = document.createElement('div');
      flash.className = 'flash';
      document.body.appendChild(flash);
      setTimeout(() => flash.remove(), 400);
    }

    function shakeBox() {
      resultBox.classList.add('shake');
      setTimeout(() => resultBox.classList.remove('shake'), 500);
    }

    /* ===== PH√ÅO HOA LI√äN T·ª§C & CH·∫¨M ===== */
    setInterval(() => {
      spawnFireworks(1);
    }, 3000);

    function spawnFireworks(count) {
      for (let i = 0; i < count; i++) {
        const x = Math.random() * canvas.width * 0.8 + canvas.width * 0.1;
        const y = Math.random() * canvas.height * 0.4 + canvas.height * 0.1;
        fireworkBurst(x, y);
      }
    }

    function fireworkBurst(x, y) {
      const particles = [];
      const colors = ['#ff0000', '#ffd700', '#00ffff', '#ff69b4', '#00ff00'];

      for (let i = 0; i < 120; i++) {
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 4 + 2;
        particles.push({
          x,
          y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          life: 80 + Math.random() * 40,
          color: colors[Math.floor(Math.random() * colors.length)]
        });
      }

      function animate() {
        ctx.globalCompositeOperation = 'lighter';
        particles.forEach(p => {
          ctx.beginPath();
          ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
          ctx.fillStyle = p.color;
          ctx.fill();
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.04;
          p.life--;
        });
        ctx.globalCompositeOperation = 'source-over';

        if (particles.some(p => p.life > 0)) {
          requestAnimationFrame(animate);
        }
      }

      animate();
    }

    /* ===== HOA R∆†I LI√äN T·ª§C ===== */
    setInterval(() => {
      const petal = document.createElement('div');
      petal.className = 'petal';
      petal.style.left = Math.random() * window.innerWidth + 'px';
      petal.style.animationDuration = 6 + Math.random() * 4 + 's';
      document.body.appendChild(petal);
      setTimeout(() => petal.remove(), 10000);
    }, 500);

    /* ===== N·ªÄN HOA ƒê√ÄO BAY + XOAY NH·∫∏ ===== */
    const bgCanvas = document.getElementById("bgParticles");
    const bgCtx = bgCanvas.getContext("2d");

    function resizeBG() {
      bgCanvas.width = window.innerWidth;
      bgCanvas.height = window.innerHeight;
    }
    resizeBG();
    window.addEventListener("resize", resizeBG);

    const bgParticles = [];
    const BG_COUNT = 80;

    class Blossom {
      constructor() {
        this.reset();
      }
      reset() {
        this.x = Math.random() * bgCanvas.width;
        this.y = Math.random() * bgCanvas.height;
        this.size = Math.random() * 8 + 6;
        this.speedY = Math.random() * 0.4 + 0.2;
        this.speedX = (Math.random() - 0.5) * 0.3;
        this.rotation = Math.random() * Math.PI * 2;
        this.rotationSpeed = (Math.random() - 0.5) * 0.02;
        this.opacity = Math.random() * 0.4 + 0.2;
      }
      update() {
        this.x += this.speedX;
        this.y += this.speedY;
        this.rotation += this.rotationSpeed;

        if (this.y > bgCanvas.height + 20) {
          this.y = -20;
          this.x = Math.random() * bgCanvas.width;
        }
        if (this.x > bgCanvas.width) this.x = 0;
        if (this.x < 0) this.x = bgCanvas.width;
      }
      draw() {
        bgCtx.save();
        bgCtx.translate(this.x, this.y);
        bgCtx.rotate(this.rotation);
        bgCtx.globalAlpha = this.opacity;
        bgCtx.fillStyle = "#ffb7c5";

        bgCtx.beginPath();
        for (let i = 0; i < 5; i++) {
          const angle = (i * Math.PI * 2) / 5;
          const r = this.size;
          bgCtx.lineTo(Math.cos(angle) * r, Math.sin(angle) * r);
        }
        bgCtx.closePath();
        bgCtx.fill();

        bgCtx.restore();
      }
    }

    for (let i = 0; i < BG_COUNT; i++) {
      bgParticles.push(new Blossom());
    }

    function animateBG() {
      bgCtx.clearRect(0, 0, bgCanvas.width, bgCanvas.height);
      bgParticles.forEach(p => {
        p.update();
        p.draw();
      });
      requestAnimationFrame(animateBG);
    }
    animateBG();
  </script>
</body>
</html>
